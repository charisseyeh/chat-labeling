<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversation Title Selector</title>
    <link rel="stylesheet" href="styles/theme.css">
    <link rel="stylesheet" href="styles/buttons.css">
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/dark-mode.css">
    <link rel="stylesheet" href="styles/page.css">
    <link rel="stylesheet" href="styles/top-section.css">
    <link rel="stylesheet" href="styles/conversation-list.css">
    <link rel="stylesheet" href="styles/conversation.css">
    <link rel="stylesheet" href="styles/messages.css">
    <link rel="stylesheet" href="styles/upload.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <script src="js/header.js"></script>

    <!-- Upload Interface (shown when no conversations.json exists) -->
    <div id="uploadInterface" class="upload-interface" style="display: none;">
        <div class="upload-container">
            <div class="upload-card card-section">
                <h2>Upload Your Conversations</h2>
                <p>Upload your ChatGPT conversations JSON file to get started.</p>
                
                <div class="upload-area">
                    <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="handleFileSelect()">
                    <button id="uploadBtn" class="btn btn--accent btn--lg" onclick="document.getElementById('fileInput').click()">
                        <i class="fas fa-upload"></i>
                        Upload
                    </button>
                    <p id="selectedFileName" style="margin-top: 10px; color: #666;"></p>
                </div>
                
                <div id="uploadStatus" style="margin-top: 10px;"></div>
            </div>
        </div>
    </div>

    <!-- Conversation Selector Interface (shown when conversations.json exists) -->
    <div id="conversationInterface" class="conversation-layout" style="display: none;">
        <div class="survey-sidebar">
            <div class="survey-container">
                <div class="turn-filter-section card-section">
                    <p>Conversations longer than 6 turns were selected. <span id="longConversationCount">0</span> out of <span id="totalConversationCount">0</span> conversations loaded.</p>
                </div>
                <div class="date-range-section card-section">
                    <h2>Auto-filter conversations</h2>
                    <p>Label your chats as relevant vs not relevant using LLM to make it easier to select the right chats</p>
                    <h3>Filter date range</h3>
                    <p>Filter conversations by date range to analyze specific model versions</p>
                    
                    <div class="date-range-controls">
                        <div class="date-presets">
                            <label for="modelPreset">Model Version Preset</label>
                            <select id="modelPreset" onchange="setDateRangeFromDropdown()">
                                <option value="">Select Model Version</option>
                                <optgroup label="GPT-5 Models">
                                    <option value="gpt-5">GPT-5 (Aug 7, 2025+)</option>
                                </optgroup>
                                <optgroup label="GPT-4o Models">
                                    <option value="gpt-4o-latest">GPT-4o Latest (Jul 2025+)</option>
                                    <option value="gpt-4o-2025">GPT-4o 2025 (Jan 2025-Jun 2025)</option>
                                    <option value="gpt-4o-2024">GPT-4o 2024 (May 2024-Dec 2024)</option>
                                </optgroup>
                                <optgroup label="GPT-3.5-turbo Models">
                                    <option value="gpt-3.5-turbo-0125">GPT-3.5-turbo-0125 (Apr 2024+)</option>
                                    <option value="gpt-3.5-turbo-1106">GPT-3.5-turbo-1106 (Nov 2023-Apr 2024)</option>
                                    <option value="gpt-3.5-turbo-16k">GPT-3.5-turbo-16k (Jun 2023-Nov 2023)</option>
                                    <option value="gpt-3.5-turbo">GPT-3.5-turbo (Mar 2023-Jun 2023)</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="date-input-row">
                            <div class="date-input-group">
                                <label for="startDate">Start Date</label>
                                <input type="date" id="startDate" onchange="updateDateRange()">
                            </div>
                            <div class="date-input-group">
                                <label for="endDate">End Date</label>
                                <input type="date" id="endDate" onchange="updateDateRange()">
                            </div>
                        </div>
                    </div>
                    
                    <div class="date-range-info">
                        <span id="filteredCount">0</span> conversations in selected date range
                    </div>

                    <div class="card-section api-key-section">
                        <div class="input-row">
                            <input type="password" id="apiKeyInput" placeholder="openai api key" />
                            <button class="btn btn--outline" onclick="saveApiKeyFromInput()">Save key</button>
                            <button class="btn" onclick="clearApiKeyFromUI()">Clear</button>
                        </div>
                        <div id="apiKeyStatus" class="api-key-status">Loading API key...</div>
                    </div>

                    <button id="analyzeBtn" class="btn btn--accent btn--md" onclick="analyzeWithAI()" disabled>
                        <span class="btn-text">Auto-filter</span>
                        <div class="btn-progress" style="display: none;">
                            <div class="btn-progress-fill"></div>
                            <span class="btn-progress-text">0%</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <div class="conversation-main">
            <div class="filter-controls">
                <div class="filter-group">
                    <button id="selectAllBtn" class="btn btn--outline" onclick="selectAll()">Select All</button>
                    <button id="deselectAllBtn" class="btn btn--outline" onclick="deselectAll()">Deselect all</button>
                </div>
                <div class="filter-group">
                    <div class="filter-buttons">
                        <button class="btn btn--chip relevant" data-category="relevant" onclick="filterByCategory('relevant')">Relevant</button>
                        <button class="btn btn--chip not-relevant" data-category="not-relevant" onclick="filterByCategory('not-relevant')">Non-relevant</button>
                    </div>
                </div>
                <div class="filter-group">
                    <input type="text" id="searchInput" placeholder="Search conversations..." class="search-input">
                </div>
            </div>

            <div id="conversationList" class="conversation-list">
                <!-- Conversations will be loaded here -->
            </div>
        </div>
    </div>

    <script src="js/dark-mode.js"></script>
    <script src="js/ai-labeling.js"></script>
    <script src="js/conversation-selector.js"></script>
</body>
</html>